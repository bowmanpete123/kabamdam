# Design Spec: CLI Interface (2.1)

## Requirement Traceability
- **Roadmap Item**: 2.1 CLI Interface ("Wrap up" command)
- **Goal**: Implement a pipeline to parse data, render SVG, and inject results into README.

## CLI Architecture
- **Library**: `typer`
- **Entry Point**: `src/kabamdam/main.py`

### Command: `kabamdam`
```bash
kabamdam [OPTIONS]
```

> [!IMPORTANT]
> To ensure `kabamdam` works as a standalone command after being installed from PyPI (just like `pytest`), we will use the standard **`[project.scripts]`** entry point in `pyproject.toml`:
>
> ```toml
> [project.scripts]
> kabamdam = "kabamdam.main:app"
> ```
>
> This is the industry-standard way to transform a Python module into a global command-line tool. It requires no extra effort from the userâ€”they just `pip install` and run the command.

**Options**:
- `--roadmap-file`: Path to the roadmap markdown file (Default: `docs/roadmap/ROADMAP.md`).
- `--timesheet-file`: Path to the timesheet markdown file (Default: `timesheets.md`).
- `--readme-file`: Path to the README to update (Default: `README.md`).
- `--output-svg`: Path where the SVG will be saved (Default: `docs/roadmap/status.svg`).

## Logic Flow
1. **Load Data**:
    - Instantiate `RoadmapParser` and `TimesheetParser`.
    - Parse the roadmap and timesheet files.
2. **Generate SVG**:
    - Instantiate `SVGGenerator`.
    - Generate the SVG string from roadmap tasks.
3. **Save SVG**:
    - Write the SVG string to `--output-svg`.
4. **README Injection**:
    - Read `--readme-file`.
    - Detect markers: `<!-- KABAMDAM:START -->` and `<!-- KABAMDAM:END -->`.
    - Construct the replacement block:
      ```markdown
      <!-- KABAMDAM:START -->
      ![Status Heatmap](relative/path/to/svg)

      [Roadmap](relative/path/to/roadmap) | [Timesheets](relative/path/to/timesheet)
      <!-- KABAMDAM:END -->
      ```
    - Replace the existing block (or append if not found, though markers are preferred).

## Technical Decomposition
- **Unit**: `CLIApp`
  - High-level orchestration.
- **Unit**: `READMEUpdater`
  - Logic for marker detection and template injection.

## Data Models (Pydantic)
- `CLIConfig`: Storing paths and settings.

## Risks
- Incorrect relative paths in README if the SVG is moved.
- Marker deletion by user.
